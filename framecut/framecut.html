
<!DOCTYPE html> 
<html> 
<body> 

<!-- 비디오태그 시작 -->
<!-- 비디오태그는 브라우저에 따라 영향을 많이 받음, 이것을 video.js로 대체 가능할 것 같음 -->
<video width="400" controls id="testVideo">
  <source src="http://media.w3.org/2010/05/sintel/trailer.mp4" type="video/mp4">
  Your browser does not support HTML5 video.
</video>

<p>These are the frames' images generated by getVideoImage():</p>
<ol id="olFrames"></ol> 
<!-- ol태그안에 잘린 프레임들을 넣을 예정 -->

<script type="text/JavaScript">
function getVideoImage(path, secs, callback) { // getVideoImage을 함수선언식으로 함수 만듬, 매개변수(영상경로, 초를 return하는 함수, 초를 계산하는 콜백함수)
  var me = this, video = document.getElementById("testVideo") // 비디오태그를 video 변수에 넣음
  video.onseeked = function(e) { // video태그에 onseeked(영상 스크롤 바를 건드릴 때)라는 이벤트가 있음, e는 event약자
    var canvas = document.createElement('canvas');
    canvas.height = video.videoHeight;
    canvas.width = video.videoWidth;
    var ctx = canvas.getContext('2d'); // canvas태그의 getContext('2d')라는 것을 ctx라는 변수에 넣음
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height); //잘린 프레임창의 크기를 결정하는 것, context.drawImage(image, dx, dy, dw, dh) => rawImage(이미지, width시작위치, height시작위치, width끝위치, height끝위치)
    var img = new Image(); // Image로 Html에 출력하기 => https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/Image
    img.src = canvas.toDataURL(); // canvas로 image의 url을 만들어서 img.src에 집어 넣음
    callback.call(me, img, this.currentTime, e); // 콜백함수 실행, this.currentTime은 video.currentTime을 의미한다.
  };
  video.onerror = function(e) {
    callback.call(me, undefined, undefined, e); // 콜백함수 실행
  };
  video.src = path; // video.src에 경로 넣음
}



function showImageAt(secs) { // 매개변수로 secs(초)를 받아옴
  var duration;
  getVideoImage(
    'http://media.w3.org/2010/05/sintel/trailer.mp4',
    function(totalTime) {
      duration = totalTime;
      return secs;
    },
    function(img, secs, event) {  // *이게 콜백함수*
      if (event.type == 'seeked') {
        var li = document.createElement('li');
        li.innerHTML += '<b>Frame at second ' + secs + ':</b><br />'; // 자른 이미지의 시간을 <b>태그로 보여줌
        li.appendChild(img); // li 밑에 자른 이미지의 정보를 가진 img태그를 만듬
        document.getElementById('olFrames').appendChild(li);
        if (duration >= ++secs) {
          showImageAt(secs);
        };
      }
    }
  );
}
showImageAt(0); // 매개변수로 0초를 주고 있다.
</script>

</body> 
</html>